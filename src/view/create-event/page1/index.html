<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/create-event/page1/style.css">
    <script defer src="../../script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>Crear evento</title>
</head>
<body>
    <div class="container">
        <div class="form-container">
            <div class="create-event-title">Crear evento</div>
            <div class="date-time-group">
                <div class="date-label">Fecha</div>
                <div class="time-label">Hora</div>
                <input class="date-input" type="date" value="00:00"/>
                <input class="time-input" type="time"/>
            </div>
            <div class="name-group">
                <label for="name">Nombre</label>
                <input class="input-field" />
            </div>
            <div class="description-group">
                <label for="description">Descripción</label>
                <textarea class="input-field description-field"></textarea>
            </div>
            <div class="location-group">
                <label for="location">Ubicación</label>
                <input class="input-field" />
            </div>
            <button class="next-button", onclick="saveEventData()">Siguiente</button>
            <button class="cancel-button", onclick="goToAdminPanel()">Cancel</button>
        </div>
        <div class="icons">
            <div class="icon" onclick="goToLogout()">
                <img alt="Log out" src="/create-event/page1/../../global_assets/logout.svg">
            </div>
            <div class="icon" onclick="goToEditProfile()">
                <img alt="User" src="/create-event/page1/../../global_assets/user.svg">
            </div>
            <div class="icon" onclick="goToEvents()">
                <img alt="Home" src="/create-event/page1/../../global_assets/home.svg">
            </div>
        </div>
    </div>
    <script>
        function isValidDate(dateString) {
            const regex = /^\d{4}-\d{2}-\d{2}$/;
            if (!regex.test(dateString)) return false;
            
            const date = new Date(dateString);
            return !isNaN(date.getTime());
        }

        function isValidTime(timeString) {
            if (timeString.includes('--') || timeString.endsWith(':') || 
            timeString.split(':')[1]?.length !== 2) {  
                return false;
            }

            const regex = /^([01]?[0-9]|2[0-3]):[0-5][0-9]$/;
            return regex.test(timeString);
        }

        function saveEventData() {
            const eventData = {
                date: document.querySelector('.date-input').value,
                time: document.querySelector('.time-input').value,
                name: document.querySelector('.name-group .input-field').value,
                description: document.querySelector('.description-group .input-field').value,
                location: document.querySelector('.location-group .input-field').value
            };

            if (eventData.name === "" || !eventData.time  === "" || eventData.date  === "" || eventData.date  === "" || eventData.location === "") {
                Swal.fire({ icon: "error", text: 'Por favor, complete todos los campos.' });
                return;
            }

            // Validación específica de fecha
            if (!isValidDate(eventData.date)) {
                Swal.fire({ 
                    icon: "error", 
                    text: 'Formato de fecha inválido. Use DD-MM-YYYY' 
                });
                return;
            }

            // Validación específica de hora
            if (!isValidTime(eventData.time)) {
                Swal.fire({ 
                    icon: "error", 
                    text: 'Formato de hora inválido/incompleto. Use HH:MM en formato 24 horas' 
                });
                return;
            }

            localStorage.setItem('eventData', JSON.stringify(eventData));
            window.location.href = '/createevent2/';
        }
    </script>
</body>
</html>